{"version":3,"file":"db-977606ff.js","sources":["../../../../../../src/lib/api.js","../../../../../../node_modules/browser-cookies/src/browser-cookies.js","../../../../../../src/lib/stores/persist.js","../../../../../../src/lib/data/icons.json?raw","../../../../../../src/lib/data/index.js","../../../../../../src/lib/stores/db.js"],"sourcesContent":["// noinspection JSUnusedGlobalSymbols\n\nimport { variables } from '$lib/variables'\n\nconst GLOBAL_TIMEOUT = 5000\nconst GLOBAL_RETRIES = 3\nconst GLOBAL_RETRY_DELAY = 100\n\nconst delay = delay => new Promise(resolve => setTimeout(() => resolve(), delay))\n\nconst fetchWithTimeout = async (resource, options = {}, f) => {\n\t//console.log(`fetchWithTimeout(${resource})`)\n\n\tlet id = null\n\tlet response\n\n\tif (typeof AbortController === 'function') {\n\t\tconst { timeout = GLOBAL_TIMEOUT } = options\n\t\tconst controller = new AbortController()\n\t\tid = setTimeout(() => controller.abort(), timeout)\n\n\t\tif (typeof f === 'function') {\n\t\t\t//console.log(`Server-side fetch ${resource}`)\n\t\t\tresponse = await f(resource, { ...options, signal: controller.signal })\n\t\t} else {\n\t\t\tresponse = await fetch(resource, { ...options, signal: controller.signal })\n\t\t}\n\t} else {\n\t\tif (typeof f === 'function') {\n\t\t\t//console.log(`Server-side fetch ${resource}`)\n\t\t\tresponse = await f(resource, options)\n\t\t} else {\n\t\t\tresponse = await fetch(resource, options)\n\t\t}\n\t}\n\n\tif (id !== null) {\n\t\tclearTimeout(id)\n\t}\n\n\treturn response\n}\n\nconst fetchWithRetryDelay = async (resource, options = {}, f, n = GLOBAL_RETRIES) => {\n\t//console.log(`fetchWithRetryDelay(${resource})`)\n\n\ttry {\n\t\treturn await fetchWithTimeout(resource, options, f)\n\t} catch(error) {\n\t\tconsole.error(error)\n\n\t\tif (n === 1) throw error\n\n\t\tawait delay(GLOBAL_RETRY_DELAY)\n\n\t\treturn fetchWithRetryDelay(resource, options, f, n - 1)\n\t}\n}\n\nexport const getSettings = (f, options) => fetchWithRetryDelay(`/settings`, options, f)\nexport const getVersion = (f, options) => fetchWithRetryDelay( variables.DEV ? 'https://emuos.emupedia.net/emuos/version.json' : '/emuos/version.json', options, f)","exports.defaults = {};\r\n\r\nexports.set = function(name, value, options) {\r\n  // Retrieve options and defaults\r\n  var opts = options || {};\r\n  var defaults = exports.defaults;\r\n\r\n  // Apply default value for unspecified options\r\n  var expires  = opts.expires  || defaults.expires;\r\n  var domain   = opts.domain   || defaults.domain;\r\n  var path     = opts.path     !== undefined ? opts.path     : (defaults.path !== undefined ? defaults.path : '/');\r\n  var secure   = opts.secure   !== undefined ? opts.secure   : defaults.secure;\r\n  var httponly = opts.httponly !== undefined ? opts.httponly : defaults.httponly;\r\n  var samesite = opts.samesite !== undefined ? opts.samesite : defaults.samesite;\r\n\r\n  // Determine cookie expiration date\r\n  // If succesful the result will be a valid Date, otherwise it will be an invalid Date or false(ish)\r\n  var expDate = expires ? new Date(\r\n      // in case expires is an integer, it should specify the number of days till the cookie expires\r\n      typeof expires === 'number' ? new Date().getTime() + (expires * 864e5) :\r\n      // else expires should be either a Date object or in a format recognized by Date.parse()\r\n      expires\r\n  ) : 0;\r\n\r\n  // Set cookie\r\n  document.cookie = name.replace(/[^+#$&^`|]/g, encodeURIComponent)                // Encode cookie name\r\n  .replace('(', '%28')\r\n  .replace(')', '%29') +\r\n  '=' + value.replace(/[^+#$&/:<-\\[\\]-}]/g, encodeURIComponent) +                  // Encode cookie value (RFC6265)\r\n  (expDate && expDate.getTime() >= 0 ? ';expires=' + expDate.toUTCString() : '') + // Add expiration date\r\n  (domain   ? ';domain=' + domain     : '') +                                      // Add domain\r\n  (path     ? ';path='   + path       : '') +                                      // Add path\r\n  (secure   ? ';secure'               : '') +                                      // Add secure option\r\n  (httponly ? ';httponly'             : '') +                                      // Add httponly option\r\n  (samesite ? ';samesite=' + samesite : '');                                       // Add samesite option\r\n};\r\n\r\nexports.get = function(name) {\r\n  var cookies = document.cookie.split(';');\r\n  \r\n  // Iterate all cookies\r\n  while(cookies.length) {\r\n    var cookie = cookies.pop();\r\n\r\n    // Determine separator index (\"name=value\")\r\n    var separatorIndex = cookie.indexOf('=');\r\n\r\n    // IE<11 emits the equal sign when the cookie value is empty\r\n    separatorIndex = separatorIndex < 0 ? cookie.length : separatorIndex;\r\n\r\n    var cookie_name = decodeURIComponent(cookie.slice(0, separatorIndex).replace(/^\\s+/, ''));\r\n\r\n    // Return cookie value if the name matches\r\n    if (cookie_name === name) {\r\n      return decodeURIComponent(cookie.slice(separatorIndex + 1));\r\n    }\r\n  }\r\n\r\n  // Return `null` as the cookie was not found\r\n  return null;\r\n};\r\n\r\nexports.erase = function(name, options) {\r\n  exports.set(name, '', {\r\n    expires:  -1,\r\n    domain:   options && options.domain,\r\n    path:     options && options.path,\r\n    secure:   0,\r\n    httponly: 0}\r\n  );\r\n};\r\n\r\nexports.all = function() {\r\n  var all = {};\r\n  var cookies = document.cookie.split(';');\r\n\r\n  // Iterate all cookies\r\n  while(cookies.length) {\r\n    var cookie = cookies.pop();\r\n\r\n    // Determine separator index (\"name=value\")\r\n    var separatorIndex = cookie.indexOf('=');\r\n\r\n    // IE<11 emits the equal sign when the cookie value is empty\r\n    separatorIndex = separatorIndex < 0 ? cookie.length : separatorIndex;\r\n\r\n    // add the cookie name and value to the `all` object\r\n    var cookie_name = decodeURIComponent(cookie.slice(0, separatorIndex).replace(/^\\s+/, ''));\r\n    all[cookie_name] = decodeURIComponent(cookie.slice(separatorIndex + 1));\r\n  }\r\n\r\n  return all;\r\n};\r\n","// noinspection JSUnusedGlobalSymbols\n\n// Converted @macfja/svelte-persistent-store to plain JS from Typescript\n// https://github.com/MacFJA/svelte-persistent-store/blob/main/src/index.ts\n\n// import ESSerializer from 'esserializer'\n// import { serialize, deserialize, addGlobalAllowedClass } from '@macfja/serializer'\nimport { get as getCookie, set as setCookie, erase as removeCookie } from 'browser-cookies'\nimport { get, set, createStore, del } from 'idb-keyval'\n// import Cyrup from 'cyrup'\n\n/**\n * The behavior when no encryption library is available when requesting an encrypted storage\n */\nexport const NO_ENCRYPTION_BEHAVIOR = {\n\t/**\n\t * Throw an exception\n\t */\n\tEXCEPTION: 0,\n\t/**\n\t * Use the wrapped Storage as-is\n\t */\n\tNO_ENCRYPTION: 1,\n\t/**\n\t * Don't use any storage, so no not encrypted data will be persisted\n\t */\n\tNO_STORAGE: 2\n}\n\n/**\n * Disabled warnings about missing/unavailable storages\n */\nexport function disableWarnings() { noWarnings = true }\n\n/**\n * Set the behavior when no encryption library is available when requesting an encrypted storage\n * @param behavior\n */\n// export function noEncryptionBehavior(behavior) { noEncryptionMode = behavior }\n\n/**\n * If set to true, no warning will be emitted if the requested Storage is not found.\n * This option can be useful when the lib is used on a server.\n */\nlet noWarnings = true\n/**\n * The chosen behavior when no encryption library is available\n */\n// let noEncryptionMode = NO_ENCRYPTION_BEHAVIOR.EXCEPTION\n\n/**\n * List of storages where the warning have already been displayed.\n */\nconst alreadyWarnFor = []\n\nconst warnUser = message => {\n\tconst isProduction = typeof process !== 'undefined' && process.env?.NODE_ENV === 'production'\n\n\tif (!noWarnings && alreadyWarnFor.indexOf(message) === -1 && !isProduction) {\n\t\tif (typeof window === 'undefined') {\n\t\t\tmessage += '\\n' + 'Are you running on a server? Most of storages are not available while running on a server.'\n\t\t}\n\n\t\tconsole.warn(message)\n\t\talreadyWarnFor.push(message)\n\t}\n}\n\n/**\n * Add a log to indicate that the requested Storage have not been found.\n * @param {string} storageName\n */\nconst warnStorageNotFound = storageName => warnUser(`Unable to find the ${storageName}. No data will be persisted.`)\n\n/*\n/**\n * Add a class to the allowed list of classes to be serialized\n * @param classDef The class to add to the list\n */\n/*export const addSerializableClass = classDef => { addGlobalAllowedClass(classDef) }*/\n\n// const serialize = value => ESSerializer.serialize(value)\nconst serialize = data => {\n\tif (typeof data === 'undefined') {\n\t\treturn 'undefined'\n\t}\n\n\treturn JSON.stringify(data)\n}\n\nconst deserialize = text => {\n\tif (typeof text !== 'string') {\n\t\treturn text\n\t}\n\n\tif (text === 'undefined') {\n\t\treturn undefined\n\t}\n\n\tif (text !== null && text !== undefined) {\n\t\t/*try {\n\t\t\treturn ESSerializer.deserialize(value, allowedClasses)\n\t\t} catch (e) {\n\t\t\t// Do nothing\n\t\t\t// use the value \"as is\"\n\t\t}*/\n\t\ttry {\n\t\t\treturn JSON.parse(text)\n\t\t} catch (e) {\n\t\t\t// Do nothing\n\t\t\t// use the value \"as is\"\n\t\t}\n\t}\n\n\treturn text\n}\n\n/**\n * Make a store persistent\n * @param {object} store The store to enhance\n * @param {object} storage The storage to use\n * @param {string} key The name of the data key\n */\nexport function persist(store, storage, key) {\n\tconst initialValue = storage.getValue(key)\n\n\tif (null !== initialValue) {\n\t\tstore.set(initialValue)\n\t}\n\n\tif (storage.addListener) {\n\t\tstorage.addListener(key, newValue => store.set(newValue))\n\t}\n\n\tstore.subscribe(value => storage.setValue(key, value))\n\n\treturn {\n\t\t...store,\n\t\tdelete() {\n\t\t\tstorage.deleteValue(key)\n\t\t}\n\t}\n}\n\nconst sharedCookieStorage = createCookieStorage(), sharedLocalStorage = createLocalStorage(), sharedSessionStorage = createSessionStorage()\n\n/**\n * Persist a store into a cookie\n * @param {object} store The store to enhance\n * @param {string} cookieName The name of the cookie\n */\nexport function persistCookie(store, cookieName) {\n\treturn persist(store, sharedCookieStorage, cookieName)\n}\n\n/**\n * Persist a store into the browser session storage\n * @param {object} store The store to enhance\n * @param {string} key The name of the key in the browser session storage\n */\nexport function persistBrowserSession(store, key) {\n\treturn persist(store, sharedSessionStorage, key)\n}\n\n/**\n * Persist a store into the browser local storage\n * @param {object} store The store to enhance\n * @param {string} key The name of the key in the browser local storage\n */\nexport function persistBrowserLocal(store, key) {\n\treturn persist(store, sharedLocalStorage, key)\n}\n\nfunction getBrowserStorage(browserStorage, listenExternalChanges = false) {\n\tconst listeners = []\n\n\tconst listenerFunction = event => {\n\t\tconst eventKey = event.key\n\n\t\tif (event.storageArea === browserStorage) {\n\t\t\tlisteners.filter(({ key }) => key === eventKey).forEach(({ listener }) => listener(deserialize(event.newValue)))\n\t\t}\n\t}\n\n\tconst connect = () => {\n\t\tif (listenExternalChanges && typeof window !== 'undefined' && window?.addEventListener) {\n\t\t\twindow.addEventListener('storage', listenerFunction)\n\t\t}\n\t}\n\n\tconst disconnect = () => {\n\t\tif (listenExternalChanges && typeof window !== 'undefined' && window?.removeEventListener) {\n\t\t\twindow.removeEventListener('storage', listenerFunction)\n\t\t}\n\t}\n\n\treturn {\n\t\taddListener(key, listener) {\n\t\t\tlisteners.push({key, listener})\n\n\t\t\tif (listeners.length === 1) {\n\t\t\t\tconnect()\n\t\t\t}\n\t\t},\n\t\tremoveListener(key, listener) {\n\t\t\tconst index = listeners.indexOf({key, listener})\n\n\t\t\tif (index !== -1) {\n\t\t\t\tlisteners.splice(index, 1)\n\t\t\t}\n\n\t\t\tif (listeners.length === 0) {\n\t\t\t\tdisconnect()\n\t\t\t}\n\t\t},\n\t\tgetValue(key) {\n\t\t\tconst value = browserStorage.getItem(key)\n\n\t\t\treturn deserialize(value)\n\t\t},\n\t\tdeleteValue(key) {\n\t\t\tbrowserStorage.removeItem(key)\n\t\t},\n\t\tsetValue(key, value) {\n\t\t\tbrowserStorage.setItem(key, serialize(value))\n\t\t}\n\t}\n}\n\n/**\n * Storage implementation that use the browser local storage\n * @param {boolean} listenExternalChanges Update the store if the localStorage is updated from another page\n */\nexport function createLocalStorage(listenExternalChanges = false) {\n\tif (typeof window !== 'undefined' && window?.localStorage) {\n\t\treturn getBrowserStorage(window.localStorage, listenExternalChanges)\n\t}\n\n\twarnStorageNotFound('window.localStorage')\n\n\treturn createNoopStorage()\n}\n\n/**\n * Storage implementation that use the browser session storage\n * @param {boolean} listenExternalChanges Update the store if the sessionStorage is updated from another page\n */\nexport function createSessionStorage(listenExternalChanges = false) {\n\tif (typeof window !== 'undefined' && window?.sessionStorage) {\n\t\treturn getBrowserStorage(window.sessionStorage, listenExternalChanges)\n\t}\n\n\twarnStorageNotFound('window.sessionStorage')\n\n\treturn createNoopStorage()\n}\n\n/**\n * Storage implementation that use the browser cookies\n */\nexport function createCookieStorage() {\n\tif (typeof document === 'undefined' || typeof document?.cookie !== 'string') {\n\n\t\twarnStorageNotFound('document.cookies')\n\n\t\treturn createNoopStorage()\n\t}\n\n\treturn {\n\t\tgetValue(key) {\n\t\t\tconst value = getCookie(key)\n\n\t\t\treturn deserialize(value)\n\t\t},\n\t\tdeleteValue(key) {\n\t\t\tremoveCookie(key, { samesite: 'Strict' })\n\t\t},\n\t\tsetValue(key, value) {\n\t\t\tsetCookie(key, serialize(value), { samesite: 'Strict' })\n\t\t}\n\t}\n}\n\n/**\n * Storage implementation that use the browser IndexedDB\n */\nexport function createIndexedDBStorage() {\n\tif (typeof indexedDB !== 'object' || typeof window === 'undefined' || typeof window?.indexedDB !== 'object') {\n\t\twarnStorageNotFound('IndexedDB')\n\n\t\treturn createNoopSelfUpdateStorage()\n\t}\n\n\tconst database = createStore('svelte-persist', 'persist')\n\tconst listeners = []\n\n\tconst listenerFunction = (eventKey, newValue) => {\n\t\tif (newValue === undefined) {\n\t\t\treturn\n\t\t}\n\n\t\tlisteners.filter(({ key }) => key === eventKey).forEach(({ listener }) => listener(newValue))\n\t}\n\n\treturn {\n\t\taddListener(key, listener) {\n\t\t\tlisteners.push({key, listener})\n\t\t},\n\t\tremoveListener(key, listener) {\n\t\t\tconst index = listeners.indexOf({key, listener})\n\n\t\t\tif (index !== -1) {\n\t\t\t\tlisteners.splice(index, 1)\n\t\t\t}\n\t\t},\n\t\tgetValue(key) {\n\t\t\tget(key, database).then(value => listenerFunction(key, deserialize(value)))\n\n\t\t\treturn null\n\t\t},\n\t\tsetValue(key, value) {\n\t\t\t// noinspection JSIgnoredPromiseFromCall\n\t\t\tset(key, serialize(value), database)\n\t\t},\n\t\tdeleteValue(key) {\n\t\t\t// noinspection JSIgnoredPromiseFromCall\n\t\t\tdel(key, database)\n\t\t}\n\t}\n}\n\n/*/**\n * Add encryption layer on a storage\n * @param wrapped The storage to enhance\n * @param encryptionKey The encryption key to use on key and data\n */\n/*export function createEncryptedStorage(wrapped, encryptionKey) {\n\tif (typeof window === 'undefined' || typeof window?.crypto !== 'object' || typeof window?.crypto?.subtle !== 'object') {\n\t\tswitch (noEncryptionMode) {\n\t\t\tcase NO_ENCRYPTION_BEHAVIOR.NO_STORAGE:\n\t\t\t\twarnUser('Unable to find the encryption library. No data will be persisted.')\n\t\t\t\treturn createNoopStorage()\n\t\t\tcase NO_ENCRYPTION_BEHAVIOR.NO_ENCRYPTION:\n\t\t\t\twarnUser('Unable to find the encryption library. Data will not be encrypted.')\n\t\t\t\treturn wrapped\n\t\t\tcase NO_ENCRYPTION_BEHAVIOR.EXCEPTION:\n\t\t\tdefault:\n\t\t\t\tthrow new Error('Unable to find the encryption library.')\n\t\t}\n\t}\n\n\tconst listeners = []\n\n\tconst listenerFunction = (eventKey, newValue) => {\n\t\tif (newValue === undefined) {\n\t\t\treturn\n\t\t}\n\n\t\tlisteners.filter(({ key }) => key === eventKey).forEach(({ listener }) => listener(newValue))\n\t}\n\n\treturn {\n\t\taddListener(key, listener) {\n\t\t\tlisteners.push({key, listener})\n\t\t},\n\t\tremoveListener(key, listener) {\n\t\t\tconst index = listeners.indexOf({key, listener})\n\n\t\t\tif (index !== -1) {\n\t\t\t\tlisteners.splice(index, 1)\n\t\t\t}\n\t\t},\n\t\tgetValue(key) {\n\t\t\tCyrup.encrypt(key, encryptionKey, null, 'sps').then(encryptedKey => {\n\t\t\t\tconst storageValue = wrapped.getValue(encryptedKey)\n\n\t\t\t\tif (storageValue === null) return undefined\n\n\t\t\t\treturn Cyrup.decrypt(storageValue, encryptionKey)\n\t\t\t}).then(decryptedData => listenerFunction(key, deserialize(decryptedData)))\n\n\t\t\treturn null\n\t\t},\n\t\tsetValue(key, value) {\n\t\t\tCyrup.encrypt(key, encryptionKey, null, 'sps').then(encryptedKey => Cyrup.encrypt(serialize(value), encryptionKey, null, 'sps').then(encryptedData => wrapped.setValue(encryptedKey, encryptedData)))\n\t\t},\n\t\tdeleteValue(key) {\n\t\t\tCyrup.encrypt(key, encryptionKey, null, 'sps').then(encryptedKey => wrapped.deleteValue(encryptedKey))\n\t\t}\n\t}\n}*/\n\n/**\n * Storage implementation that do nothing\n */\nexport function createNoopStorage() {\n\treturn {\n\t\tgetValue() {\n\t\t\treturn null\n\t\t},\n\t\tdeleteValue() {\n\t\t\t// Do nothing\n\t\t},\n\t\tsetValue() {\n\t\t\t// Do nothing\n\t\t}\n\t}\n}\n\nfunction createNoopSelfUpdateStorage() {\n\treturn {\n\t\taddListener() {\n\t\t\t// Do nothing\n\t\t},\n\t\tremoveListener() {\n\t\t\t// Do nothing\n\t\t},\n\t\tgetValue() {\n\t\t\treturn null\n\t\t},\n\t\tdeleteValue() {\n\t\t\t// Do nothing\n\t\t},\n\t\tsetValue() {\n\t\t\t// Do nothing\n\t\t}\n\t}\n}","export default \"[{\\n\\t\\\"name\\\": \\\"My Computer\\\"\\n} , {\\n\\t\\\"name\\\": \\\"Network Neighborhood\\\"\\n} , {\\n\\t\\\"name\\\": \\\"Recycle Bin\\\"\\n} , {\\n\\t\\\"name\\\": \\\"(C)\\\",\\n\\t\\\"shortcut\\\": true\\n} , {\\n\\t\\\"name\\\": \\\"Control Panel\\\",\\n\\t\\\"shortcut\\\": true\\n} , {\\n\\t\\\"name\\\": \\\"System\\\",\\n\\t\\\"shortcut\\\": true\\n}]\"","// noinspection JSUnusedGlobalSymbols\n\nimport iconsData from '$lib/data/icons?raw'\n\nlet icons = {}\n\ntry {\n\ticons = JSON.parse(iconsData)\n} catch (err) {\n\tconsole.error(err)\n}\n\nexport { icons }","// noinspection JSUnusedGlobalSymbols\n\nimport { writable } from 'svelte/store'\nimport { persist, createLocalStorage } from '$lib/stores/persist'\nimport { icons } from '$lib/data'\nimport { variables } from '$lib/variables'\n\nconst initial = {\n\tlocale: 'en',\n\tdesktop: { icons: icons || [] },\n\tsettings: {},\n\tversion: 0,\n\tuser: null,\n\tdev: false\n}\n\nif (variables?.GLOBAL_DEBUG) {\n\tconsole.log(initial)\n}\n\nexport const db = persist(writable(initial), createLocalStorage(), 'db')\n\nconst parseAxis = target => axis => parseFloat(getComputedStyle(target).getPropertyValue(`--${axis}`))\n\nexport const setCoordinates = (e, el, name) => {\n\tdb.update(data => {\n\t\tdata.desktop.icons.forEach(icon => {\n\t\t\tif (icon.name === name) {\n\t\t\t\ticon.x = parseAxis(el)('x') || 0\n\t\t\t\ticon.y = parseAxis(el)('y') || 0\n\t\t\t}\n\t\t})\n\n\t\treturn data\n\t})\n}\n\nexport const toast = (() => {\n\tconst { subscribe, update } = writable([])\n\n\tconst defaults = {\n\t\tduration: 4000,\n\t\tinitial: 1,\n\t\tnext: 0,\n\t\tpausable: false,\n\t\tdismissable: true,\n\t\treversed: false,\n\t\tintro: { x: 256 },\n\t\tclose: '✕'\n\t}\n\n\tlet count = 0\n\n\tconst options = {}\n\n\tconst open = (msg, opts = {}) => {\n\t\tconst param = { target: 'default', ...(msg instanceof Object ? msg : { ...opts, msg }) }\n\n\t\tconst conf = options[param.target] || {}\n\n\t\tconst entry = {\n\t\t\t...defaults,\n\t\t\t...conf,\n\t\t\t...param,\n\t\t\ttheme: { ...conf.theme, ...param.theme },\n\t\t\tclasses: [...(conf.classes || []), ...(param.classes || [])],\n\t\t\tid: param.id || ++count\n\t\t}\n\n\t\tupdate(n => {\n\t\t\tconst idx = n.findIndex(i => i.id === param.id)\n\n\t\t\tif (idx === -1) {\n\t\t\t\treturn entry.reversed ? [...n, entry] : [entry, ...n]\n\t\t\t} else if (idx > -1) {\n\t\t\t\tn[idx] = { ...n[idx], ...entry }\n\t\t\t}\n\n\t\t\treturn n\n\t\t})\n\n\t\treturn count\n\t}\n\n\tconst close = id => {\n\t\tupdate(n => {\n\t\t\tif (!n.length || id === 0) return []\n\n\t\t\tif (id instanceof Object) return n.filter(i => id(i))\n\n\t\t\tconst target = id || Math.max(...n.map(i => i.id))\n\n\t\t\treturn n.filter(i => i.id !== target)\n\t\t})\n\t}\n\n\tconst set = (id, opts = {}) => {\n\t\tconst param = id instanceof Object ? { ...id } : { ...opts, id }\n\n\t\tupdate(n => {\n\t\t\tconst idx = n.findIndex(i => i.id === param.id)\n\n\t\t\tif (idx > -1) {\n\t\t\t\tn[idx] = { ...n[idx], ...param }\n\t\t\t}\n\n\t\t\treturn n\n\t\t})\n\t}\n\n\tconst init = (target = 'default', opts = {}) => {\n\t\toptions[target] = opts\n\n\t\treturn options\n\t}\n\n\treturn { subscribe, open, close, set, init }\n})()"],"names":["GLOBAL_TIMEOUT","GLOBAL_RETRIES","GLOBAL_RETRY_DELAY","delay","resolve","fetchWithTimeout","resource","options","f","id","response","timeout","controller","fetchWithRetryDelay","n","error","getVersion","variables","exports","name","value","opts","defaults","expires","domain","path","secure","httponly","samesite","expDate","cookies","cookie","separatorIndex","cookie_name","all","warnUser","message","_a","warnStorageNotFound","storageName","serialize","data","deserialize","text","persist","store","storage","key","initialValue","newValue","createCookieStorage","createLocalStorage","createSessionStorage","getBrowserStorage","browserStorage","listenExternalChanges","listeners","listenerFunction","event","eventKey","listener","connect","disconnect","index","createNoopStorage","getCookie","removeCookie","setCookie","iconsData","icons","err","initial","db","writable","parseAxis","target","axis","setCoordinates","el","icon","toast","subscribe","update","count","msg","param","conf","entry","idx","i"],"mappings":"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"}